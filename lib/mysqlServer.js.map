{"version":3,"sources":["mysqlServer.js"],"names":["mysqld","startingPromise","readySet","stoppingPromise","mysqlServerReady","reinitialize","ready","then","resolve","stopMysqlServer","reject","stop","on","console","log"],"mappings":";;;;;;;;;;;AAAA;;;;;;AAEA,IAAIA,SAAS,IAAb;AACA,IAAIC,kBAAkB,IAAtB;AACA,IAAIC,WAAW,KAAf;AACA,IAAIC,kBAAkB,IAAtB;AACO,MAAMC,8CAAmB,YAAW;AACzC,MAAIH,eAAJ,EAAqB;AACnB,WAAOA,eAAP;AACD;;AAED,MAAI,CAACC,QAAL,EAAe;AACbF,aAAS,2BAAW,IAAX,EAAiB,EAACK,cAAc,KAAf,EAAjB,CAAT;AACAJ,sBAAkBD,OAAOM,KAAP,CAAaC,IAAb,CAAkB,MAAM;AACxCL,iBAAW,IAAX;AACAD,wBAAkB,IAAlB;AACD,KAHiB,CAAlB;AAIA,WAAOA,eAAP;AACD,GAPD,MAOO;AACL,WAAO,kBAAQO,OAAR,CAAgB,IAAhB,CAAP;AACD;AACF,CAfM;;AAiBA,MAAMC,4CAAkB,YAAW;AACxC,MAAIN,eAAJ,EAAqB;AACnB,WAAOA,eAAP;AACD;;AAEDA,oBAAkB,sBAAY,CAACK,OAAD,EAAUE,MAAV,KAAqB;AACjDN,uBAAmBG,IAAnB,CAAwB,MAAMP,OAAOW,IAAP,EAA9B;AACAX,WAAOY,EAAP,CAAU,OAAV,EAAmB,MAAM;AACvBC,cAAQC,GAAR,CAAY,sBAAZ;AACAd,eAAS,IAAT;AACAC,wBAAkB,IAAlB;AACAC,iBAAW,KAAX;AACAC,wBAAkB,IAAlB;AACAK;AACD,KAPD;AAQD,GAViB,CAAlB;AAWA,SAAOL,eAAP;AACD,CAjBM","file":"mysqlServer.js","sourcesContent":["import startMysql from \"mysql-server-5.7-osx-x64\";\n\nlet mysqld = null\nlet startingPromise = null\nlet readySet = false\nlet stoppingPromise = null\nexport const mysqlServerReady = function() {\n  if (startingPromise) {\n    return startingPromise\n  }\n\n  if (!readySet) {\n    mysqld = startMysql(null, {reinitialize: false})\n    startingPromise = mysqld.ready.then(() => {\n      readySet = true\n      startingPromise = null\n    })\n    return startingPromise\n  } else {\n    return Promise.resolve(true)\n  }\n}\n\nexport const stopMysqlServer = function() {\n  if (stoppingPromise) {\n    return stoppingPromise\n  }\n\n  stoppingPromise = new Promise((resolve, reject) => {\n    mysqlServerReady().then(() => mysqld.stop())\n    mysqld.on('close', () => {\n      console.log('stopped mysql server')\n      mysqld = null\n      startingPromise = null\n      readySet = false\n      stoppingPromise = null\n      resolve()\n    })\n  })\n  return stoppingPromise\n}"]}